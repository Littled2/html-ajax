window.addEventListener("load",ajax_init);function ajax_init(){async function t(t,e,a,i){let o;try{o=await (await fetch(t)).text()}catch(l){n(`something went wrong fetching data from ${t}`,l)}a&&(o=i.json?r(a,JSON.parse(o)):r(a,o)),e.innerHTML=o}async function e(t,e){try{return await (await fetch(t,{method:"POST",body:e})).text()}catch(a){return n("Could not submit form",a),"Error Submitting"}}function a(t){let e={};try{t.trim();let a=t.replace(/ /g,"").split(",");for(let r=0;r<a.length;r++){let[i,o]=a[r].split(":");"true"===o?o=!0:"false"===o&&(o=!1),e[i]=o}return""!==e?e:{}}catch(l){return n("Malformed options string",l),{}}}function r(t,e){try{return t(e)}catch(a){return n(`error parsing data from ${url}`,a),"An error occured"}}function n(t,e){e&&console.error(e),console.error(`${e?"INFO ABOUT THE ABOVE ERROR \n":""} ajax-get error: ${t}`)}async function i(t,a,r,n,i){t.preventDefault();let o=new FormData;for(let l of n)o.append(l.getAttribute("ajax-data"),l.value);let s=await e(a,o),u=new Event("ajax-post-complete");r.dispatchEvent(u);let c=!0;i&&"overwrite"in i&&(c=i.overwrite),c&&(r.innerHTML=s)}window.ajax={},window.ajax.listeners={},document.querySelectorAll("*[ajax-get]").forEach(e=>{var r;let n=e.getAttribute("ajax-get"),i=e.getAttribute("ajax-options");i&&(i=a(i));let o=(r=e.getAttribute("ajax-parser"),r&&Object(window).hasOwnProperty(r)&&"function"==typeof window[r]?window[r]:null),l=e.getAttribute("ajax-listener");l&&(Object(window.ajax.listeners).hasOwnProperty(l)||(window.ajax.listeners[l]=[]),window.ajax.listeners[l].push([n,e,o,i])),e.hasAttribute("ajax-defer")||t(n,e,o,i)}),document.querySelectorAll("*[ajax-update]").forEach(e=>{let a=e.getAttribute("ajax-update");if(!a)return;let r=e.getAttribute("ajax-trigger");r||(r="FORM"!==e.tagName?"click":"ajax-post-complete"),e.addEventListener(r,()=>(function e(a){if(Object(window.ajax.listeners).hasOwnProperty(a))for(let r=0;r<window.ajax.listeners[a].length;r++){let[n,i,o,l]=window.ajax.listeners[a][r];t(n,i,o,l)}})(a))}),document.querySelectorAll("*[ajax-post]").forEach(t=>{let e=t.getAttribute("ajax-post");if("FORM"!==t.tagName){console.warn("ajax-post must be defined on a <form> tag");return}let r=t.querySelectorAll("*[ajax-data]"),n=t.getAttribute("ajax-options");n&&(n=a(n)),t.addEventListener("submit",a=>i(a,e,t,r,n))})}
